using CVnHR.Business.Kvk;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System;
using System.Runtime.Serialization;
using System.Threading.Tasks;

namespace CVnHR.Business.Tests.Kvk
{
    [TestClass]
    public class HRDataserviceMessageParserTests
    {
        [TestMethod, Description("Should correctly parse a message to a MaatschappelijkeActiviteitResponseType")]
        public void Parse()
        {
            // Arrange
            var msg = @"<soap:Envelope xmlns:soap=""http://schemas.xmlsoap.org/soap/envelope/""><SOAP-ENV:Header xmlns:SOAP-ENV=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:wsa=""http://www.w3.org/2005/08/addressing""><wsse:Security soap:mustUnderstand=""1"" xmlns:wsse=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"" xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd""><wsu:Timestamp wsu:Id=""id-2-c02e7c79e5bfce26db62424a3b0ce4b3""><wsu:Created>2019-03-13T21:03:37.877Z</wsu:Created><wsu:Expires>2019-03-13T21:08:37.877Z</wsu:Expires></wsu:Timestamp><wsse:BinarySecurityToken EncodingType=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary"" ValueType=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3"" wsu:Id=""id-0-e2c6f73be2ed9e993ef14c4cdd43f854"" xmlns:wsse=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"">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</wsse:BinarySecurityToken><ds:Signature xmlns:ds=""http://www.w3.org/2000/09/xmldsig#""><ds:SignedInfo><ds:CanonicalizationMethod Algorithm=""http://www.w3.org/2001/10/xml-exc-c14n#""/><ds:SignatureMethod Algorithm=""http://www.w3.org/2001/04/xmldsig-more#rsa-sha256""/><ds:Reference URI=""#id-1-2742949bc021e8b8903eb4c919f91b12""><ds:Transforms><ds:Transform Algorithm=""http://www.w3.org/2001/10/xml-exc-c14n#""/></ds:Transforms><ds:DigestMethod Algorithm=""http://www.w3.org/2001/04/xmlenc#sha256""/><ds:DigestValue>kKnsWainqS8hjamH2qxS11tg06Jb1JWIOAtpSd4RIEQ=</ds:DigestValue></ds:Reference><ds:Reference URI=""#id-3-3a5c53e4e93e51062353ac7772f0da1e""><ds:Transforms><ds:Transform Algorithm=""http://www.w3.org/2001/10/xml-exc-c14n#""/></ds:Transforms><ds:DigestMethod Algorithm=""http://www.w3.org/2001/04/xmlenc#sha256""/><ds:DigestValue>GE6hLX/doFAxvM2uarMP7Yr5l4CbdWhSkOT/XY7QmwM=</ds:DigestValue></ds:Reference><ds:Reference URI=""#id-2-c02e7c79e5bfce26db62424a3b0ce4b3""><ds:Transforms><ds:Transform Algorithm=""http://www.w3.org/2001/10/xml-exc-c14n#""/></ds:Transforms><ds:DigestMethod Algorithm=""http://www.w3.org/2001/04/xmlenc#sha256""/><ds:DigestValue>Vzc45xjYtwgYoLV76TG/YgjF0sYLuzmLvcV6NvvFotw=</ds:DigestValue></ds:Reference><ds:Reference URI=""#id-0-c09512cd434fa23ebf25aa871978bf6e""><ds:Transforms><ds:Transform Algorithm=""http://www.w3.org/2001/10/xml-exc-c14n#""/></ds:Transforms><ds:DigestMethod Algorithm=""http://www.w3.org/2001/04/xmlenc#sha256""/><ds:DigestValue>q8/wlKVdfpxjOdiYKsS1hS25m2Mr00gHHTo7UhyO/No=</ds:DigestValue></ds:Reference><ds:Reference URI=""#id-1-5af459b0811f1cd987908f46a42d7a96""><ds:Transforms><ds:Transform Algorithm=""http://www.w3.org/2001/10/xml-exc-c14n#""/></ds:Transforms><ds:DigestMethod Algorithm=""http://www.w3.org/2001/04/xmlenc#sha256""/><ds:DigestValue>5RspRWTLzIS25PRKw5fpuxTHxM6JkEaxTHI6awAsJ4I=</ds:DigestValue></ds:Reference><ds:Reference URI=""#id-2-ff371302aa3320d9b5d0c2e925a23f60""><ds:Transforms><ds:Transform Algorithm=""http://www.w3.org/2001/10/xml-exc-c14n#""/></ds:Transforms><ds:DigestMethod Algorithm=""http://www.w3.org/2001/04/xmlenc#sha256""/><ds:DigestValue>ge696YRoRtqHafwRjOdu8mqs+gIgkLS8PGom3qp1PsQ=</ds:DigestValue></ds:Reference><ds:Reference URI=""#id-4-78bec1f61210222e857e0ff236f11c30""><ds:Transforms><ds:Transform Algorithm=""http://www.w3.org/2001/10/xml-exc-c14n#""/></ds:Transforms><ds:DigestMethod Algorithm=""http://www.w3.org/2001/04/xmlenc#sha256""/><ds:DigestValue>3eGz+KClVqpjA2tJsQIF/eZR2mihXyRfSItCGKzML3k=</ds:DigestValue></ds:Reference><ds:Reference URI=""#id-0-e2c6f73be2ed9e993ef14c4cdd43f854""><ds:Transforms><ds:Transform Algorithm=""http://www.w3.org/2001/10/xml-exc-c14n#""/></ds:Transforms><ds:DigestMethod Algorithm=""http://www.w3.org/2001/04/xmlenc#sha256""/><ds:DigestValue>xy7c/dUswpzml4YX+XHsl5DBj87b16ewT3I6CL99bNE=</ds:DigestValue></ds:Reference></ds:SignedInfo><ds:SignatureValue>JBMPaZgNcFuPogR+PkTJmlx+EEjhuCY3908O6lo83wR1UtIDxDhsLhDvY6SCMsrHNnxXGq2OPYX+b4Lo/OPIExwZ7Navs9068/mHuGV+RN6Of6oule8fovuKrseMBaYo1d90hdRMqweticYrro+wWx/NdEogijJdXhdeoaSSjNcWUZSOSoasHtchMZzXwqNk0LaBzdLXe6sLKzyPt98ZH5nbm/nurMhzFs9D79i8J3pyZR6wYFPosiyvGL7ZsfZXdAmrS85latZknH6vqEBtdQppj4UajZj2z+Ns+32Xzq7CkPXoWBG13b/hXSyrlElurZYND82T649F1zrl0aIUeQ==</ds:SignatureValue><ds:KeyInfo><wsse:SecurityTokenReference xmlns:wsse=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd""><wsse:Reference URI=""#id-0-e2c6f73be2ed9e993ef14c4cdd43f854"" ValueType=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3""/></wsse:SecurityTokenReference></ds:KeyInfo></ds:Signature></wsse:Security><wsa:Action wsu:Id=""id-0-c09512cd434fa23ebf25aa871978bf6e"" xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"">http://es.kvk.nl/ophalenInschrijvingResponse</wsa:Action><wsa:MessageID wsu:Id=""id-1-5af459b0811f1cd987908f46a42d7a96"" xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"">uuid:7271b1cd-23e6-4fad-9c75-9a41f23692f8</wsa:MessageID><wsa:To wsu:Id=""id-2-ff371302aa3320d9b5d0c2e925a23f60"" xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"">http://www.w3.org/2005/08/addressing/anonymous</wsa:To><wsa:From wsu:Id=""id-3-3a5c53e4e93e51062353ac7772f0da1e"" xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd""><wsa:Address>http://es.kvk.nl/kvk-Dataservice/2015/02</wsa:Address><wsa:ReferenceParameters xmlns:wsa=""http://www.w3.org/2005/08/addressing""><ds:ResourceID xmlns:ds=""http://schemas.kvk.nl/schemas/kvk/HRIP-Dataservice"">/inschrijving/kvknummer/01179514</ds:ResourceID></wsa:ReferenceParameters></wsa:From><wsa:RelatesTo wsa:RelationshipType=""http://www.w3.org/2005/08/addressing/reply"" wsu:Id=""id-4-78bec1f61210222e857e0ff236f11c30"" xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"">uuid:beccc27d-ffc6-47fa-bfcf-d7587e888572</wsa:RelatesTo></SOAP-ENV:Header><soap:Body wsu:Id=""id-1-2742949bc021e8b8903eb4c919f91b12"" xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd""><ophalenInschrijvingResponse peilmoment=""20190313220201652"" xmlns=""http://schemas.kvk.nl/schemas/hrip/dataservice/2015/02""><meldingen><informatie><code>IPD0000</code><omschrijving>Het product is succesvol geproduceerd.</omschrijving><referentie>01179514</referentie></informatie></meldingen><product><cat:maatschappelijkeActiviteit xmlns:cat=""http://schemas.kvk.nl/schemas/hrip/catalogus/2015/02""><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:kvkNummer>01179514</cat:kvkNummer><cat:nonMailing><cat:code>J</cat:code><cat:omschrijving>Ja</cat:omschrijving><cat:referentieType>geenRT</cat:referentieType></cat:nonMailing><cat:pensioenvennootschap><cat:code>N</cat:code><cat:omschrijving>Nee</cat:omschrijving><cat:referentieType>geenRT</cat:referentieType></cat:pensioenvennootschap><cat:sbiActiviteit><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:sbiCode><cat:code>8411</cat:code><cat:omschrijving>Algemeen overheidsbestuur</cat:omschrijving><cat:referentieType>ActiviteitCode</cat:referentieType></cat:sbiCode><cat:isHoofdactiviteit><cat:code>J</cat:code><cat:omschrijving>Ja</cat:omschrijving><cat:referentieType>geenRT</cat:referentieType></cat:isHoofdactiviteit><cat:volgorde>1</cat:volgorde></cat:sbiActiviteit><cat:incidenteelUitlenenArbeidskrachten><cat:code>J</cat:code><cat:omschrijving>Ja</cat:omschrijving><cat:referentieType>geenRT</cat:referentieType></cat:incidenteelUitlenenArbeidskrachten><cat:bezoekLocatie><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:afgeschermd><cat:code>N</cat:code><cat:omschrijving>Nee</cat:omschrijving><cat:referentieType>geenRT</cat:referentieType></cat:afgeschermd><cat:adres><cat:binnenlandsAdres><cat:straatnaam>Westerbrink</cat:straatnaam><cat:huisnummer>1</cat:huisnummer><cat:postcode><cat:cijfercombinatie>9405</cat:cijfercombinatie><cat:lettercombinatie>BJ</cat:lettercombinatie></cat:postcode><cat:plaats>Assen</cat:plaats><cat:bagId><cat:identificatieNummeraanduiding>0106200000027367</cat:identificatieNummeraanduiding><cat:identificatieAdresseerbaarObject>0106010000027367</cat:identificatieAdresseerbaarObject></cat:bagId></cat:binnenlandsAdres></cat:adres><cat:volledigAdres>Westerbrink 1 9405BJ Assen</cat:volledigAdres></cat:bezoekLocatie><cat:postLocatie><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:afgeschermd><cat:code>N</cat:code><cat:omschrijving>Nee</cat:omschrijving><cat:referentieType>geenRT</cat:referentieType></cat:afgeschermd><cat:adres><cat:binnenlandsAdres><cat:postbusnummer>122</cat:postbusnummer><cat:postcode><cat:cijfercombinatie>9400</cat:cijfercombinatie><cat:lettercombinatie>AC</cat:lettercombinatie></cat:postcode><cat:plaats>Assen</cat:plaats></cat:binnenlandsAdres></cat:adres><cat:volledigAdres>Postbus 122 9400AC Assen</cat:volledigAdres></cat:postLocatie><cat:communicatiegegevens><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:communicatienummer><cat:toegangscode>+31</cat:toegangscode><cat:nummer>0592365555</cat:nummer><cat:soort><cat:code>T</cat:code><cat:omschrijving>Telefoon</cat:omschrijving></cat:soort></cat:communicatienummer><cat:domeinNaam>www.drenthe.nl</cat:domeinNaam></cat:communicatiegegevens><cat:naam>Provincie Drenthe</cat:naam><cat:wordtUitgeoefendIn><cat:relatieRegistratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:relatieRegistratie><cat:nietCommercieleVestiging><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:vestigingsnummer>000005329256</cat:vestigingsnummer><cat:bezoekLocatie><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:afgeschermd><cat:code>N</cat:code><cat:omschrijving>Nee</cat:omschrijving><cat:referentieType>geenRT</cat:referentieType></cat:afgeschermd><cat:adres><cat:binnenlandsAdres><cat:straatnaam>Westerbrink</cat:straatnaam><cat:huisnummer>1</cat:huisnummer><cat:postcode><cat:cijfercombinatie>9405</cat:cijfercombinatie><cat:lettercombinatie>BJ</cat:lettercombinatie></cat:postcode><cat:plaats>Assen</cat:plaats><cat:bagId><cat:identificatieNummeraanduiding>0106200000027367</cat:identificatieNummeraanduiding><cat:identificatieAdresseerbaarObject>0106010000027367</cat:identificatieAdresseerbaarObject></cat:bagId></cat:binnenlandsAdres></cat:adres><cat:volledigAdres>Westerbrink 1 9405BJ Assen</cat:volledigAdres></cat:bezoekLocatie><cat:postLocatie><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:afgeschermd><cat:code>N</cat:code><cat:omschrijving>Nee</cat:omschrijving><cat:referentieType>geenRT</cat:referentieType></cat:afgeschermd><cat:adres><cat:binnenlandsAdres><cat:postbusnummer>122</cat:postbusnummer><cat:postcode><cat:cijfercombinatie>9400</cat:cijfercombinatie><cat:lettercombinatie>AC</cat:lettercombinatie></cat:postcode><cat:plaats>Assen</cat:plaats></cat:binnenlandsAdres></cat:adres><cat:volledigAdres>Postbus 122 9400AC Assen</cat:volledigAdres></cat:postLocatie><cat:communicatiegegevens><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:communicatienummer><cat:toegangscode>+31</cat:toegangscode><cat:nummer>0592365555</cat:nummer><cat:soort><cat:code>T</cat:code><cat:omschrijving>Telefoon</cat:omschrijving></cat:soort></cat:communicatienummer><cat:domeinNaam>www.drenthe.nl</cat:domeinNaam></cat:communicatiegegevens><cat:eersteHandelsnaam>Provincie Drenthe</cat:eersteHandelsnaam><cat:naamgeving><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:naam>Provincie Drenthe</cat:naam></cat:naamgeving><cat:activiteiten><cat:omschrijving>Uitvoeren van provinciale overheidstaken</cat:omschrijving><cat:sbiActiviteit><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:sbiCode><cat:code>8411</cat:code><cat:omschrijving>Algemeen overheidsbestuur</cat:omschrijving><cat:referentieType>ActiviteitCode</cat:referentieType></cat:sbiCode><cat:isHoofdactiviteit><cat:code>J</cat:code><cat:omschrijving>Ja</cat:omschrijving><cat:referentieType>geenRT</cat:referentieType></cat:isHoofdactiviteit></cat:sbiActiviteit></cat:activiteiten></cat:nietCommercieleVestiging></cat:wordtUitgeoefendIn><cat:wordtGeleidVanuit><cat:nietCommercieleVestiging><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:vestigingsnummer>000005329256</cat:vestigingsnummer><cat:bezoekLocatie><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:afgeschermd><cat:code>N</cat:code><cat:omschrijving>Nee</cat:omschrijving><cat:referentieType>geenRT</cat:referentieType></cat:afgeschermd><cat:adres><cat:binnenlandsAdres><cat:straatnaam>Westerbrink</cat:straatnaam><cat:huisnummer>1</cat:huisnummer><cat:postcode><cat:cijfercombinatie>9405</cat:cijfercombinatie><cat:lettercombinatie>BJ</cat:lettercombinatie></cat:postcode><cat:plaats>Assen</cat:plaats><cat:bagId><cat:identificatieNummeraanduiding>0106200000027367</cat:identificatieNummeraanduiding><cat:identificatieAdresseerbaarObject>0106010000027367</cat:identificatieAdresseerbaarObject></cat:bagId></cat:binnenlandsAdres></cat:adres><cat:volledigAdres>Westerbrink 1 9405BJ Assen</cat:volledigAdres></cat:bezoekLocatie><cat:postLocatie><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:afgeschermd><cat:code>N</cat:code><cat:omschrijving>Nee</cat:omschrijving><cat:referentieType>geenRT</cat:referentieType></cat:afgeschermd><cat:adres><cat:binnenlandsAdres><cat:postbusnummer>122</cat:postbusnummer><cat:postcode><cat:cijfercombinatie>9400</cat:cijfercombinatie><cat:lettercombinatie>AC</cat:lettercombinatie></cat:postcode><cat:plaats>Assen</cat:plaats></cat:binnenlandsAdres></cat:adres><cat:volledigAdres>Postbus 122 9400AC Assen</cat:volledigAdres></cat:postLocatie><cat:communicatiegegevens><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:communicatienummer><cat:toegangscode>+31</cat:toegangscode><cat:nummer>0592365555</cat:nummer><cat:soort><cat:code>T</cat:code><cat:omschrijving>Telefoon</cat:omschrijving></cat:soort></cat:communicatienummer><cat:domeinNaam>www.drenthe.nl</cat:domeinNaam></cat:communicatiegegevens><cat:eersteHandelsnaam>Provincie Drenthe</cat:eersteHandelsnaam><cat:naamgeving><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:naam>Provincie Drenthe</cat:naam></cat:naamgeving><cat:activiteiten><cat:omschrijving>Uitvoeren van provinciale overheidstaken</cat:omschrijving><cat:sbiActiviteit><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:sbiCode><cat:code>8411</cat:code><cat:omschrijving>Algemeen overheidsbestuur</cat:omschrijving><cat:referentieType>ActiviteitCode</cat:referentieType></cat:sbiCode><cat:isHoofdactiviteit><cat:code>J</cat:code><cat:omschrijving>Ja</cat:omschrijving><cat:referentieType>geenRT</cat:referentieType></cat:isHoofdactiviteit></cat:sbiActiviteit></cat:activiteiten></cat:nietCommercieleVestiging></cat:wordtGeleidVanuit><cat:heeftAlsEigenaar><cat:relatieRegistratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:relatieRegistratie><cat:rechtspersoon><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>00000000</cat:datumAanvang></cat:registratie><cat:persoonRechtsvorm>Publiekrechtelijke Rechtspersoon</cat:persoonRechtsvorm><cat:volledigeNaam>Provincie Drenthe</cat:volledigeNaam><cat:uitgebreideRechtsvorm>Publiekrechtelijke Rechtspersoon: Provincie</cat:uitgebreideRechtsvorm><cat:heeft><cat:gemachtigde><cat:registratie registratieTijdstip=""20181220103856473""><cat:datumAanvang>20181015</cat:datumAanvang></cat:registratie><cat:functietitel><cat:registratie registratieTijdstip=""20181220103856473""><cat:datumAanvang>20181015</cat:datumAanvang></cat:registratie><cat:titel>Organisatiebesluit provincie Drenthe 2018</cat:titel><cat:isStatutaireTitel><cat:code>N</cat:code><cat:omschrijving>Nee</cat:omschrijving><cat:referentieType>geenRT</cat:referentieType></cat:isStatutaireTitel></cat:functietitel><cat:door><cat:naamPersoon/></cat:door><cat:functie><cat:code>24</cat:code><cat:omschrijving>Privaatrechtelijk gevolmachtigde</cat:omschrijving><cat:referentieType>FunctionarisRol</cat:referentieType></cat:functie><cat:volmacht><cat:registratie registratieTijdstip=""20181220103856473""><cat:datumAanvang>20181015</cat:datumAanvang></cat:registratie><cat:typeVolmacht><cat:code>b</cat:code><cat:omschrijving>Beperkte volmacht</cat:omschrijving><cat:referentieType>VolmachtType</cat:referentieType></cat:typeVolmacht><cat:isStatutair><cat:code>N</cat:code><cat:omschrijving>Nee</cat:omschrijving><cat:referentieType>geenRT</cat:referentieType></cat:isStatutair><cat:beperkteVolmacht><cat:magOpgaveHandelsregisterDoen><cat:code>J</cat:code><cat:omschrijving>Ja</cat:omschrijving><cat:referentieType>geenRT</cat:referentieType></cat:magOpgaveHandelsregisterDoen><cat:heeftOverigeVolmacht><cat:code>J</cat:code><cat:omschrijving>Ja</cat:omschrijving><cat:referentieType>geenRT</cat:referentieType></cat:heeftOverigeVolmacht></cat:beperkteVolmacht></cat:volmacht></cat:gemachtigde></cat:heeft><cat:rsin>001587924</cat:rsin><cat:naamgeving><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:naam>Provincie Drenthe</cat:naam></cat:naamgeving><cat:rechtsvorm><cat:code>PR</cat:code><cat:omschrijving>Publiekrechtelijke Rechtspersoon</cat:omschrijving><cat:referentieType>Rechtsvorm</cat:referentieType></cat:rechtsvorm><cat:publiekrechtelijkeRechtsvorm><cat:code>03</cat:code><cat:omschrijving>Provincie</cat:omschrijving><cat:referentieType>NadereSpecificatiePubliekrechtelijkeRechtsvorm</cat:referentieType></cat:publiekrechtelijkeRechtsvorm><cat:datumEersteInschrijvingHandelsregister>00000000</cat:datumEersteInschrijvingHandelsregister><cat:bezoekLocatie><cat:registratie registratieTijdstipNoValue=""vastgesteldOnbekend""><cat:datumAanvang>18510101</cat:datumAanvang></cat:registratie><cat:afgeschermd><cat:code>N</cat:code><cat:omschrijving>Nee</cat:omschrijving><cat:referentieType>geenRT</cat:referentieType></cat:afgeschermd><cat:adres><cat:binnenlandsAdres><cat:straatnaam>Westerbrink</cat:straatnaam><cat:huisnummer>1</cat:huisnummer><cat:postcode><cat:cijfercombinatie>9405</cat:cijfercombinatie><cat:lettercombinatie>BJ</cat:lettercombinatie></cat:postcode><cat:plaats>Assen</cat:plaats><cat:bagId><cat:identificatieNummeraanduiding>0106200000027367</cat:identificatieNummeraanduiding><cat:identificatieAdresseerbaarObject>0106010000027367</cat:identificatieAdresseerbaarObject></cat:bagId></cat:binnenlandsAdres></cat:adres><cat:volledigAdres>Westerbrink 1 9405BJ Assen</cat:volledigAdres></cat:bezoekLocatie></cat:rechtspersoon></cat:heeftAlsEigenaar></cat:maatschappelijkeActiviteit></product></ophalenInschrijvingResponse></soap:Body></soap:Envelope>";

            var parser = new HRDataserviceMessageParser();

            // Act
            var result = parser.Parse(msg);

            // Assert
            Assert.IsNotNull(result);
            Assert.IsInstanceOfType(result, typeof(MaatschappelijkeActiviteitResponseType));
            Assert.AreEqual("IPD0000", result.meldingen.informatie[0].code);
            Assert.AreEqual("01179514", result.product.maatschappelijkeActiviteit.kvkNummer);
        }

        [TestMethod, Description("Should throw when parsing an empty message")]
        [ExpectedException(typeof(SerializationException))]
        public void Parse_EmptyMessage()
        {
            // Arrange
            var parser = new HRDataserviceMessageParser();

            // Act
            var result = parser.Parse("");
        }

        [TestMethod, Description("Should correctly serialize a ophalenInschrijvingRequest message")]
        public void SerializeOphalenInschrijvingRequest()
        {
            // Arrange
            var reference = "ACC_I_002";
            var kvkNumber = "8541214521";
            var expectedMessage = $@"<ophalenInschrijvingRequest xmlns=""http://schemas.kvk.nl/schemas/hrip/dataservice/2015/02""><klantreferentie>{reference}</klantreferentie><kvkNummer>{kvkNumber}</kvkNummer></ophalenInschrijvingRequest>";
            var parser = new HRDataserviceMessageParser();
            var request = new ophalenInschrijvingRequest(
                new InschrijvingRequestType()
                {
                    Item = kvkNumber,
                    klantreferentie = reference,
                    ItemElementName = ItemChoiceType.kvkNummer
                }
            );

            // Act
            var msg = parser.SerializeOphalenInschrijvingRequest(request);

            //Assert
            msg = msg
             .Replace(Environment.NewLine, string.Empty)
             .Replace("  ", string.Empty)
             .Replace("  ", string.Empty)
             .Replace("  ", string.Empty)
             .Replace(" <", "<");
            Assert.AreEqual(expectedMessage, msg);
        }
    }
}
